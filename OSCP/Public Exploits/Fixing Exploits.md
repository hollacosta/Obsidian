### 13.2.3 Question 1
For this exercise, prior to getting this you must turn Apache2 on the machine
![[Pasted image 20231015183559.png]]


![[Pasted image 20231015182008.png]]

given the server info is a CMS Made Simple RCE Exploit with credentials, since it is a 2.2.5, we are using 44976.py
![[Pasted image 20231015182149.png]]
created a copy named 44976_modified.py
changed the parameters for the following
	Base_url
	Upload_dir
	Upload split
	username
	password
![[Pasted image 20231015182357.png]]
The "String that is being split " line was made so we can see the difference and change the csrf_parameter. after adding the string to add the location, we can see that need to add the "_sk_" into the csrf_parameter (it was previously __c in original code)
![[Pasted image 20231015183833.png]]
after changing those parameters, we will add Verify=False variable into the responses so we do not get errors
![[Pasted image 20231015182629.png]]
![[Pasted image 20231015182536.png]]
![[Pasted image 20231015182614.png]]
after setting those parameters, we can run and get the shell

![[Pasted image 20231015184011.png]]
from there, create a rev shell that works (always upgrade the shell)
![[Pasted image 20231015184309.png]]

### 13.2.3 Question 2 (Mofule Exercise VM #1)
![[Pasted image 20231015184419.png]]
use the same principle behind looking for a searchsploit to find the appropiate script
modified the script to use /cmsms and http 
![[Pasted image 20231015184623.png]]
notice the different directories in this one
	base_url = **http:**//192.168.240.52/cmsms/admin
	upload_dir = "/uploads"
	upload_url 
	username
	password

same principle with the other one = once shell created, upgrade shell
![[Pasted image 20231015185540.png]]
for this one, had to find the right payload via msfvenom

### 13.2.3 Question 3 (Mofule Exercise VM #2)
![[Pasted image 20231015190212.png]]
![[Pasted image 20231015195657.png]]

http://192.168.195.46/**seclab/php/editors/editor.php**

found from the dirbuster search

![[Pasted image 20231016180315.png]]
we found an RCE for elFinder
USE 46481.PY
![[Pasted image 20231016183256.png]]
move the sample.jpg file to the Downloads
changed the name to SecSignal (as the exploit 46481.py shows)
moved it to /home/hollacosta
run exploit 
![[Pasted image 20231016183349.png]]
got the shell!
### 13.2.3 Question 4

![[Pasted image 20231016183419.png]]
![[Pasted image 20231016183728.png]]
I do an aggressive scan after getting the ports
I filtered all the ports and performed an aggressive scan with OS Discovery on the open ports
![[Pasted image 20231016191833.png]]

![[Pasted image 20231016191855.png]]
use the 50999.py (Remote stack buffer overflow)
Create the shellcode needed to match my tun0 and port
![[Pasted image 20231016192056.png]]
I changed the host IP and port to match the nmap scan

**TO GET THE RIGHT SHELL FOR NC, USE THE PAYLOAD THAT DOESN'T NEED METERPRETER**

![[Pasted image 20231016205334.png]]
remember to start your search simple, go from there


